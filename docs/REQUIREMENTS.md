# hachimi-tui éœ€æ±‚æ–‡æ¡£

> hachimi-world éŸ³ä¹å¹³å°çš„ç»ˆç«¯è½»é‡æ’­æ”¾å™¨å®¢æˆ·ç«¯

---

## 1. äº§å“æ¦‚è¿°

### 1.1 å®šä½

hachimi-tui æ˜¯ hachimi-world éŸ³ä¹å¹³å°çš„ç»ˆç«¯å®¢æˆ·ç«¯ï¼Œå®šä½ä¸º**è½»é‡çº§æ’­æ”¾å™¨**ã€‚ä¸“æ³¨äºŽéŸ³ä¹æµè§ˆã€æœç´¢å’Œæ’­æ”¾ä½“éªŒï¼Œä¸åŒ…å«åˆ›ä½œå‘å¸ƒã€å®¡æ ¸ç­‰å†…å®¹ç®¡ç†åŠŸèƒ½ã€‚

### 1.2 ç›®æ ‡ç”¨æˆ·

- åå¥½ç»ˆç«¯å·¥ä½œæµçš„å¼€å‘è€…å’Œé«˜çº§ç”¨æˆ·
- åœ¨æ— å›¾å½¢ç•Œé¢çš„æœåŠ¡å™¨/è¿œç¨‹çŽ¯å¢ƒä¸­ä½¿ç”¨çš„ç”¨æˆ·
- éœ€è¦ä½Žèµ„æºå ç”¨éŸ³ä¹æ’­æ”¾å™¨çš„ç”¨æˆ·

### 1.3 æŠ€æœ¯æ ˆ

| ç»„ä»¶       | é€‰åž‹                |
| ---------- | ------------------- |
| è¯­è¨€       | Rust                |
| TUI æ¡†æž¶   | Ratatui + Crossterm |
| éŸ³é¢‘æ’­æ”¾   | rodio + symphonia   |
| HTTP å®¢æˆ·ç«¯ | reqwest             |
| å¼‚æ­¥è¿è¡Œæ—¶ | tokio               |
| åºåˆ—åŒ–     | serde + serde_json  |
| å°é¢æ¸²æŸ“   | ratatui-image           |
| æœ¬åœ°å­˜å‚¨   | æ–‡ä»¶ç³»ç»Ÿ (JSON/è‡ªå®šä¹‰æ ¼å¼) |

---

## 2. è§†è§‰è®¾è®¡è¯­è¨€

### 2.1 é£Žæ ¼å®šä¹‰

èžåˆ**å›½é™…ä¸»ä¹‰** (International Style) ä¸Ž**æ–°ç²—é‡Žä¸»ä¹‰** (Neo-Brutalism)ï¼š

- **æ‰å¹³çŽ°ä»£**ï¼šæ— è£…é¥°é˜´å½±ï¼Œä»¥çº¯è‰²å—å’ŒæŽ’ç‰ˆå±‚çº§æž„å»ºè§†è§‰ç§©åº
- **ASCII è‰ºæœ¯**ï¼šæ ‡é¢˜ã€Logo ç­‰å…³é”®ä½ç½®ä½¿ç”¨ ASCII Art å¢žåŠ å¤å¤ç»ˆç«¯æ„Ÿ
- **è°¨æ…Žä½¿ç”¨è¾¹æ¡†**ï¼šå¤§éƒ¨åˆ†åŒºåŸŸé ç•™ç™½å’Œç¼©è¿›åˆ’åˆ†å±‚çº§ï¼Œä»…åœ¨éœ€è¦æ˜Žç¡®éš”ç¦»çš„åŒºåŸŸä½¿ç”¨è¾¹æ¡†
- **å¼ºæŽ’ç‰ˆ**ï¼šä¾èµ–å­—å·ï¼ˆå¤§å°å†™å˜åŒ–ï¼‰ã€ç²—ä½“ã€é—´è·æ¥åˆ›å»ºå±‚æ¬¡ï¼Œè€Œéžé¢œè‰²æ³›æ»¥
- **æœ‰é™è°ƒè‰²æ¿**ï¼šä¸»è‰² + å¼ºè°ƒè‰² + ç°é˜¶ï¼Œé¿å…å½©è™¹å¼é…è‰²

### 2.2 é…è‰²æ–¹æ¡ˆ

```
èƒŒæ™¯       â”€â”€â”€ ç»ˆç«¯é»˜è®¤èƒŒæ™¯
å‰æ™¯/æ­£æ–‡   â”€â”€â”€ ç»ˆç«¯é»˜è®¤å‰æ™¯
å¼ºè°ƒè‰²      â”€â”€â”€ äº®é’ (Cyan) ç”¨äºŽå½“å‰é€‰ä¸­/æ´»è·ƒçŠ¶æ€
æ¬¡è¦ä¿¡æ¯    â”€â”€â”€ ç°è‰² (DarkGray)
è­¦å‘Š/é”™è¯¯   â”€â”€â”€ çº¢ (Red)
æˆåŠŸ/åœ¨çº¿   â”€â”€â”€ ç»¿ (Green)
æ’­æ”¾è¿›åº¦    â”€â”€â”€ é’ (Cyan) å¡«å…… + ç° (DarkGray) åº•
```

### 2.3 å¸ƒå±€åŽŸåˆ™

- ä¿¡æ¯å¯†åº¦ä¼˜å…ˆï¼Œå‡å°‘æ— æ„ä¹‰çš„è£…é¥°å¡«å……
- å…³é”®æ“ä½œï¼ˆæ’­æ”¾æŽ§åˆ¶ï¼‰å§‹ç»ˆå¯è§
- åˆ—è¡¨ç±»å†…å®¹æ”¯æŒæ»šåŠ¨ï¼Œå½“å‰é€‰ä¸­é¡¹é«˜äº®
- é¿å…å¼¹çª—ï¼Œä¼˜å…ˆä½¿ç”¨å†…è”å±•å¼€æˆ–åº•éƒ¨æç¤º

---

## 3. åŠŸèƒ½éœ€æ±‚

### 3.1 è®¤è¯æ¨¡å—

#### 3.1.1 é‚®ç®±ç™»å½•

- è¾“å…¥é‚®ç®±å’Œå¯†ç 
- æ”¯æŒéªŒè¯ç  (captcha) éªŒè¯æµç¨‹
- ç™»å½•æˆåŠŸåŽæŒä¹…åŒ– token åˆ°æœ¬åœ°

#### 3.1.2 Token ç®¡ç†

- è‡ªåŠ¨åˆ·æ–°è¿‡æœŸçš„ access token
- token å­˜å‚¨åœ¨ `~/.config/hachimi-tui/auth.json`
- è®¤è¯å¤±è´¥æ—¶æç¤ºé‡æ–°ç™»å½•

#### 3.1.3 é€€å‡ºç™»å½•

- æ¸…é™¤æœ¬åœ° token
- å›žåˆ°ç™»å½•ç•Œé¢

> **ä¸å®žçŽ°**ï¼šæ³¨å†Œã€å¿˜è®°å¯†ç ï¼ˆå¼•å¯¼ç”¨æˆ·åŽ» Web/GUI ç«¯å®Œæˆï¼‰

---

### 3.2 é¦–é¡µ/å‘çŽ°

#### 3.2.1 æœ€æ–°å‘å¸ƒ

- åˆ†é¡µåŠ è½½æœ€æ–°å‘å¸ƒçš„æ­Œæ›²åˆ—è¡¨
- æ˜¾ç¤ºï¼šæ ‡é¢˜ã€å‰¯æ ‡é¢˜ã€åˆ¶ä½œè€…ã€æ—¶é•¿ã€æ’­æ”¾é‡
- å›žè½¦æ’­æ”¾ï¼Œæ”¯æŒåŠ å…¥é˜Ÿåˆ—

#### 3.2.2 æ¯æ—¥æŽ¨è

- ç™»å½•ç”¨æˆ·æ˜¾ç¤ºä¸ªæ€§åŒ–æŽ¨è
- æœªç™»å½•æ˜¾ç¤ºåŒ¿åæŽ¨è

#### 3.2.3 æ¯å‘¨çƒ­é—¨

- æ˜¾ç¤ºæœ¬å‘¨çƒ­é—¨æ­Œæ›²æŽ’è¡Œ

#### 3.2.4 åˆ†ç±»æµè§ˆ

- æ˜¾ç¤ºæŽ¨èæ ‡ç­¾åˆ—è¡¨
- é€‰ä¸­æ ‡ç­¾åŽåŠ è½½è¯¥åˆ†ç±»ä¸‹çš„æ­Œæ›²

---

### 3.3 æœç´¢

#### 3.3.1 æ­Œæ›²æœç´¢

- è¾“å…¥å…³é”®è¯æœç´¢æ­Œæ›²
- ç»“æžœæ˜¾ç¤ºï¼šæ ‡é¢˜ã€å‰¯æ ‡é¢˜ã€JMIDã€åˆ¶ä½œè€…ã€æ—¶é•¿
- æ”¯æŒæŽ’åºåˆ‡æ¢ï¼šç›¸å…³åº¦ / å‘å¸ƒæ—¶é—´ï¼ˆæ–°â†’æ—§ï¼‰/ å‘å¸ƒæ—¶é—´ï¼ˆæ—§â†’æ–°ï¼‰
- åˆ†é¡µåŠ è½½æ›´å¤šç»“æžœ

#### 3.3.2 ç”¨æˆ·æœç´¢

- è¾“å…¥å…³é”®è¯æˆ– UID æœç´¢ç”¨æˆ·
- ç»“æžœæ˜¾ç¤ºï¼šç”¨æˆ·åã€UIDã€ç®€ä»‹
- é€‰ä¸­åŽè¿›å…¥ç”¨æˆ·ç©ºé—´

#### 3.3.3 æ­Œå•æœç´¢

- è¾“å…¥å…³é”®è¯æœç´¢å…¬å¼€æ­Œå•
- ç»“æžœæ˜¾ç¤ºï¼šæ­Œå•åã€åˆ›å»ºè€…ã€æ­Œæ›²æ•°é‡

---

### 3.4 æ’­æ”¾å™¨

#### 3.4.1 éŸ³é¢‘æ’­æ”¾

- æ”¯æŒ MP3 å’Œ FLAC æ ¼å¼è§£ç æ’­æ”¾
- æµå¼æ’­æ”¾ï¼šè¾¹ä¸‹è½½è¾¹æ’­æ”¾
- æ’­æ”¾/æš‚åœã€ä¸Šä¸€æ›²/ä¸‹ä¸€æ›²
- è¿›åº¦ seekï¼ˆå¿«è¿›/å¿«é€€ï¼‰
- éŸ³é‡è°ƒèŠ‚

#### 3.4.2 æ’­æ”¾æ¨¡å¼

- é¡ºåºæ’­æ”¾
- éšæœºæ’­æ”¾
- å•æ›²å¾ªçŽ¯

#### 3.4.3 æ’­æ”¾é˜Ÿåˆ—

- æŸ¥çœ‹å½“å‰æ’­æ”¾é˜Ÿåˆ—
- æ·»åŠ æ­Œæ›²åˆ°é˜Ÿåˆ—æœ«å°¾ / æ’å…¥åˆ°ä¸‹ä¸€é¦–
- ä»Žé˜Ÿåˆ—ä¸­ç§»é™¤æ­Œæ›²
- æ¸…ç©ºé˜Ÿåˆ—
- é˜Ÿåˆ—æŒä¹…åŒ–ï¼ˆé€€å‡ºåŽæ¢å¤ï¼‰

#### 3.4.4 ReplayGain å“åº¦æ ‡å‡†åŒ–

- è¯»å–æ­Œæ›²çš„ `gain` å­—æ®µ
- åº”ç”¨å“åº¦è¡¥å¿ï¼Œç¡®ä¿ä¸åŒæ­Œæ›²éŸ³é‡ä¸€è‡´
- å¯åœ¨è®¾ç½®ä¸­å¼€å…³

#### 3.4.5 æ­Œè¯æ˜¾ç¤º

- è§£æž LRC æ ¼å¼æ­Œè¯
- éšæ’­æ”¾è¿›åº¦åŒæ­¥æ»šåŠ¨
- å½“å‰è¡Œé«˜äº®

#### 3.4.6 æ’­æ”¾çŠ¶æ€æ 

- å¸¸é©»åº•éƒ¨æ˜¾ç¤º
- ä½¿ç”¨æ‰å¹³ Unicode å›¾æ ‡ï¼Œä¸ä½¿ç”¨å½©è‰² Emojiï¼š
  ```
  â–¶  å¤œã«é§†ã‘ã‚‹ - YOASOBI       02:31 / 04:15  â£¿â£¿â£¿â£¿â£¿â£¿â£€â£€â£€â£€  â‡„  ðŸŽ§ï¸Ž80%
  ```
- å›¾æ ‡å­—å…¸ï¼š
  ```
  æ’­æ”¾     â–¶       (U+25B6)
  æš‚åœ     â¸       (U+23F8)
  ä¸Šä¸€æ›²   â®       (U+23EE)
  ä¸‹ä¸€æ›²   â­       (U+23ED)
  åœæ­¢     â¹       (U+23F9)
  é¡ºåº     â†’       (U+2192)
  éšæœº     â‡„       (U+21C4)
  å•æ›²å¾ªçŽ¯ â†»1      (U+21BB + æ•°å­—1)
  åˆ—è¡¨å¾ªçŽ¯ â†»       (U+21BB)
  éŸ³é‡     ðŸŽ§ï¸Ž      (U+1F3A7 + U+FE0E æ–‡æœ¬æ¨¡å¼)
  é™éŸ³     ðŸŽ§ï¸ŽÃ—     (è€³æœº + å‰å·)
  åŠ è½½ä¸­   â—Œ       (U+25CC)
  è¿›åº¦æ¡   â£¿â£€     (ç›²æ–‡ç‚¹é˜µ: â£¿=å·²æ’­æ”¾ â£€=æœªæ’­æ”¾)
  ```
- æ˜¾ç¤ºåŠ è½½/ç¼“å†²çŠ¶æ€

---

### 3.5 æ­Œå•ç®¡ç†

#### 3.5.1 æˆ‘çš„æ­Œå•

- æŸ¥çœ‹å·²åˆ›å»ºçš„æ­Œå•åˆ—è¡¨
- åˆ›å»ºæ–°æ­Œå•ï¼ˆè¾“å…¥åç§°å’Œæè¿°ï¼‰
- åˆ é™¤æ­Œå•

#### 3.5.2 æ­Œå•è¯¦æƒ…

- æŸ¥çœ‹æ­Œå•å†…çš„æ­Œæ›²åˆ—è¡¨
- æ’­æ”¾æ•´ä¸ªæ­Œå•
- ä»Žæ­Œå•ä¸­ç§»é™¤æ­Œæ›²
- è°ƒæ•´æ­Œæ›²é¡ºåº

#### 3.5.3 æ”¶è—æ­Œå•

- æŸ¥çœ‹æ”¶è—çš„å…¬å¼€æ­Œå•
- æ”¶è—/å–æ¶ˆæ”¶è—æ­Œå•
- åˆ†é¡µåŠ è½½

#### 3.5.4 æ·»åŠ åˆ°æ­Œå•

- åœ¨æ­Œæ›²ä¸Šä¸‹æ–‡èœå•ä¸­æ˜¾ç¤º"æ·»åŠ åˆ°æ­Œå•"
- æ˜¾ç¤ºæ­Œå•åˆ—è¡¨ï¼Œæ ‡è¯†å·²æ·»åŠ çš„æ­Œå•
- æ”¯æŒå¿«é€Ÿåˆ›å»ºæ–°æ­Œå•å¹¶æ·»åŠ 

---

### 3.6 æ’­æ”¾åŽ†å²

- è‡ªåŠ¨è®°å½•æ’­æ”¾åŽ†å²åˆ°æœåŠ¡å™¨
- åˆ†é¡µæµè§ˆæ’­æ”¾åŽ†å²
- åˆ é™¤åŽ†å²è®°å½•
- ä»ŽåŽ†å²ä¸­é‡æ–°æ’­æ”¾

---

### 3.7 ç”¨æˆ·ç©ºé—´

#### 3.7.1 ä¸ªäººç©ºé—´

- æŸ¥çœ‹ä¸ªäººèµ„æ–™ï¼ˆç”¨æˆ·åã€ç®€ä»‹ã€å¤´åƒ URLï¼‰
- æŸ¥çœ‹è‡ªå·±å‘å¸ƒçš„æ­Œæ›²

#### 3.7.2 ä»–äººç©ºé—´

- æŸ¥çœ‹å…¶ä»–ç”¨æˆ·çš„å…¬å¼€èµ„æ–™
- æµè§ˆå…¶å‘å¸ƒçš„æ­Œæ›²å’Œå…¬å¼€æ­Œå•
- æ’­æ”¾è¯¥ç”¨æˆ·çš„æ‰€æœ‰æ­Œæ›²

---

### 3.8 ç¦»çº¿ç¼“å­˜

#### 3.8.1 è‡ªåŠ¨ç¼“å­˜

- æ’­æ”¾è¿‡çš„éŸ³é¢‘æ–‡ä»¶è‡ªåŠ¨ç¼“å­˜åˆ°æœ¬åœ°
- ç¼“å­˜ä½ç½®ï¼š`~/.cache/hachimi-tui/audio/`
- ç¼“å­˜å…ƒæ•°æ®ï¼ˆæ­Œæ›²ä¿¡æ¯ï¼‰ä¸ŽéŸ³é¢‘æ–‡ä»¶åˆ†ç¦»å­˜å‚¨

#### 3.8.2 ç¼“å­˜ç®¡ç†

- æŸ¥çœ‹ç¼“å­˜å ç”¨ç©ºé—´
- æ‰‹åŠ¨æ¸…é™¤å…¨éƒ¨ç¼“å­˜
- è®¾ç½®ç¼“å­˜ä¸Šé™ï¼ˆè¶…å‡ºåŽ LRU æ·˜æ±°ï¼‰

#### 3.8.3 ç¦»çº¿æ’­æ”¾

- ç¼“å­˜è¿‡çš„æ­Œæ›²åœ¨æ— ç½‘ç»œæ—¶å¯æ’­æ”¾
- ç¦»çº¿æ—¶é˜Ÿåˆ—ä¸­æœªç¼“å­˜çš„æ­Œæ›²è‡ªåŠ¨è·³è¿‡å¹¶æç¤º

---

### 3.9 è®¾ç½®

- å“åº¦æ ‡å‡†åŒ–å¼€å…³
- é»˜è®¤éŸ³é‡
- ç¼“å­˜ä¸Šé™å¤§å°
- å„¿ç«¥æ¨¡å¼ï¼ˆè¿‡æ»¤ explicit å†…å®¹ï¼‰
- æ’­æ”¾è®¾å¤‡é€‰æ‹©ï¼ˆå¦‚æœ‰å¤šä¸ªéŸ³é¢‘è¾“å‡ºï¼‰
- é…ç½®æ–‡ä»¶è·¯å¾„ï¼š`~/.config/hachimi-tui/config.toml`

---

## 4. ç•Œé¢å¸ƒå±€

### 4.1 å¯¼èˆªæ¨¡åž‹ â€” Miller Columns

é‡‡ç”¨ç±»ä¼¼ yazi çš„ä¸‰æ å¯¼èˆªï¼Œé€šè¿‡ `h`/`l` é”®åœ¨å±‚çº§é—´é’»å‡º/é’»å…¥ï¼Œ`j`/`k` é”®åœ¨å½“å‰åˆ—ä¸Šä¸‹ç§»åŠ¨ã€‚

ä¸‰æ å›ºå®šå®½åº¦æ¯”ä¾‹ï¼Œå·¦æ çª„ï¼Œä¸­å³æ ä¸ºä¸»ç©ºé—´ï¼š

| æ       | æ¯”ä¾‹ | ç”¨é€”                     |
| ------- | ---- | ------------------------ |
| Parent  | ~15% | ä¸Šçº§ç›®å½•ï¼Œé«˜äº®å½“å‰æ‰€åœ¨é¡¹ |
| Current | ~45% | å½“å‰å±‚çº§åˆ—è¡¨ï¼Œç„¦ç‚¹æ‰€åœ¨   |
| Preview | ~40% | é€‰ä¸­é¡¹çš„é¢„è§ˆ/å­å†…å®¹      |

æ ¹å±‚çº§æ—¶ Parent æ éšè—ï¼ŒCurrent å’Œ Preview å„å çº¦ 50%ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  HACHIMI                                                     â”‚
â”‚                                                              â”‚
â”‚ Parent  â”‚ Current                      â”‚ Preview             â”‚
â”‚ (~15%)  â”‚ (~45%)                       â”‚ (~40%)              â”‚
â”‚         â”‚                              â”‚                     â”‚
â”‚         â”‚                              â”‚                     â”‚
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ â–¶ Title - Artist     01:23/03:45 â£¿â£¿â£¿â£¿â£€â£€â£€â£€  â‡„ ðŸŽ§ï¸Ž80%      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 å¯¼èˆªå±‚çº§æ ‘

```
Root
â”œâ”€â”€ Home
â”‚   â”œâ”€â”€ Latest Releases â”€â”€â†’ æ­Œæ›²åˆ—è¡¨ â”€â”€â†’ æ­Œæ›²è¯¦æƒ…
â”‚   â”œâ”€â”€ Daily Recommend â”€â”€â†’ æ­Œæ›²åˆ—è¡¨ â”€â”€â†’ æ­Œæ›²è¯¦æƒ…
â”‚   â”œâ”€â”€ Weekly Hot â”€â”€â”€â”€â”€â”€â†’ æ­Œæ›²åˆ—è¡¨ â”€â”€â†’ æ­Œæ›²è¯¦æƒ…
â”‚   â””â”€â”€ Categories â”€â”€â”€â”€â”€â”€â†’ æ ‡ç­¾åˆ—è¡¨ â”€â”€â†’ æ­Œæ›²åˆ—è¡¨ â”€â”€â†’ æ­Œæ›²è¯¦æƒ…
â”œâ”€â”€ Search â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ æœç´¢ç»“æžœ â”€â”€â†’ æ­Œæ›²/ç”¨æˆ·/æ­Œå•è¯¦æƒ…
â”œâ”€â”€ Library
â”‚   â”œâ”€â”€ My Playlists â”€â”€â”€â”€â†’ æ­Œå•åˆ—è¡¨ â”€â”€â†’ æ­Œæ›²åˆ—è¡¨ â”€â”€â†’ æ­Œæ›²è¯¦æƒ…
â”‚   â”œâ”€â”€ Favorites â”€â”€â”€â”€â”€â”€â”€â†’ æ­Œå•åˆ—è¡¨ â”€â”€â†’ æ­Œæ›²åˆ—è¡¨ â”€â”€â†’ æ­Œæ›²è¯¦æƒ…
â”‚   â””â”€â”€ History â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ æ­Œæ›²åˆ—è¡¨ â”€â”€â†’ æ­Œæ›²è¯¦æƒ…
â”œâ”€â”€ Queue â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ æ­Œæ›²åˆ—è¡¨ â”€â”€â†’ æ­Œæ›²è¯¦æƒ…
â””â”€â”€ Settings â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ è®¾ç½®é¡¹
```

### 4.3 å¯¼èˆªç¤ºä¾‹

**æ ¹å±‚çº§**ï¼ˆParent éšè—ï¼Œä¸¤æ å„åŠï¼‰ï¼š

```
â”‚ Home                     â”‚ Latest Releases            â”‚
â”‚ Search                   â”‚ Daily Recommend            â”‚
â”‚ Library                  â”‚ Weekly Hot                 â”‚
â”‚ Queue                    â”‚ Categories                 â”‚
â”‚ Settings                 â”‚                            â”‚
```

å³æ æ˜¾ç¤ºé€‰ä¸­æ ¹é¡¹ï¼ˆHomeï¼‰çš„å­ç›®å½•é¢„è§ˆã€‚

**Home â†’ Latest Releases**ï¼ˆä¸‰æ å…¨å±•ï¼Œä¸­æ æ­Œæ›²åˆ—è¡¨å« up ä¸»åï¼‰ï¼š

```
â”‚ Latest  â”‚ å¤œã«é§†ã‘ã‚‹       YOASOBI   â”‚ å¤œã«é§†ã‘ã‚‹              â”‚
â”‚ Daily   â”‚ ç¾¤é’             YOASOBI   â”‚   Subtitle             â”‚
â”‚ Weekly  â”‚ æ€ªç‰©             YOASOBI   â”‚   YOASOBI              â”‚
â”‚ Categ.. â”‚ ä¸‰åŽŸè‰²           YOASOBI   â”‚   JM-ABCD-123          â”‚
â”‚         â”‚                            â”‚   4:15  â–¶ 1234         â”‚
â”‚         â”‚                            â”‚   Tags: Pop, J-Pop     â”‚
```

ä¸­æ æ¯è¡Œæ ¼å¼ï¼š`æ ‡é¢˜` å·¦å¯¹é½ + `upä¸»å` å³å¯¹é½ï¼Œup ä¸»åä½¿ç”¨ DarkGray æ¬¡è¦è‰²ã€‚é€‰ä¸­è¡Œæ•´è¡Œ Cyan é«˜äº®ã€‚

**æœç´¢**ï¼ˆè¿›å…¥ Searchï¼Œä¸­æ é¡¶éƒ¨æœç´¢æ ï¼‰ï¼š

```
â”‚ Home    â”‚ > song query_              â”‚ å¤œã«é§†ã‘ã‚‹              â”‚
â”‚ Search  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€       â”‚   YOASOBI              â”‚
â”‚ Library â”‚ å¤œã«é§†ã‘ã‚‹       YOASOBI   â”‚   JM-ABCD-123          â”‚
â”‚ Queue   â”‚ ç¾¤é’             YOASOBI   â”‚   4:15  â–¶ 1234         â”‚
â”‚ Settingsâ”‚ æ€ªç‰©             YOASOBI   â”‚                        â”‚
```

æœç´¢æ æ”¯æŒ `Tab` åˆ‡æ¢æœç´¢ç±»åž‹ï¼ˆsong/user/playlistï¼‰ï¼Œ`Ctrl+s` åˆ‡æ¢æŽ’åºã€‚

### 4.4 æ­Œæ›²è¯¦æƒ…é¢„è§ˆï¼ˆå³æ ï¼‰

å½“é€‰ä¸­é¡¹ä¸ºæ­Œæ›²æ—¶ï¼ŒPreview æ ä¸Šæ–¹æ˜¾ç¤ºå°é¢å›¾ï¼Œä¸‹æ–¹æ˜¾ç¤ºæ–‡å­—ä¿¡æ¯ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            â”‚
â”‚  Cover Art â”‚
â”‚            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
å¤œã«é§†ã‘ã‚‹
Subtitle
YOASOBI

JM-ABCD-123
4:15  â–¶ 1234
åŽŸåˆ›

Tags
Pop  J-Pop  Vocal
```

å°é¢å›¾æ¸²æŸ“æ–¹æ¡ˆï¼šä½¿ç”¨ ratatui-image ç»„ä»¶ï¼Œè‡ªåŠ¨æŽ¢æµ‹ç»ˆç«¯æ”¯æŒçš„å›¾ç‰‡åè®®ï¼ˆKitty / iTerm2 / Sixelï¼‰ï¼Œä¸æ”¯æŒæ—¶å›žé€€åˆ°åŠå—å­—ç¬¦ã€‚

### 4.5 æ’­æ”¾å™¨å±•å¼€è§†å›¾

æŒ‰ `v` å±•å¼€æ’­æ”¾å™¨åˆ°å…¨å±ï¼Œè¦†ç›–ä¸‰æ å¯¼èˆªï¼Œæ˜¾ç¤ºæ­Œè¯ï¼š

```
  NOW PLAYING
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  å¤œã«é§†ã‘ã‚‹
  YOASOBI
  JM-ABCD-123

                                              æ²ˆã‚€ã‚ˆã†ã«æº¶ã‘ã¦ã‚†ãã‚ˆã†ã«
                                              äºŒäººã ã‘ã®ç©ºãŒåºƒãŒã‚‹å¤œã«
                                            > ã€Œã•ã‚ˆãªã‚‰ã€ã ã‘ã ã£ãŸ
                                              ãã®ä¸€è¨€ã§å…¨ã¦ãŒåˆ†ã‹ã£ãŸ

  â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£€â£€â£€â£€â£€â£€â£€  02:31 / 04:15

              â®    â¸    â­         â‡„       ðŸŽ§ï¸Ž80%
```

---

## 5. é”®ç»‘å®š

### 5.1 å…¨å±€

| é”®              | åŠ¨ä½œ            |
| --------------- | --------------- |
| `q` / `Ctrl+C`  | é€€å‡º            |
| `Space`         | æ’­æ”¾/æš‚åœ       |
| `n`             | ä¸‹ä¸€æ›²          |
| `N`             | ä¸Šä¸€æ›²          |
| `+` / `=`       | éŸ³é‡å¢žå¤§        |
| `-`             | éŸ³é‡å‡å°        |
| `>`             | å¿«è¿› 5 ç§’       |
| `<`             | å¿«é€€ 5 ç§’       |
| `s`             | åˆ‡æ¢æ’­æ”¾æ¨¡å¼    |
| `v`             | å±•å¼€/æ”¶èµ·æ’­æ”¾å™¨ |
| `/`             | èšç„¦æœç´¢        |

### 5.2 Miller Columns å¯¼èˆª

| é”®              | åŠ¨ä½œ                       |
| --------------- | -------------------------- |
| `j` / `â†“`      | ä¸‹ç§»                       |
| `k` / `â†‘`      | ä¸Šç§»                       |
| `l` / `â†’` / `Enter` | é’»å…¥é€‰ä¸­é¡¹            |
| `h` / `â†`      | è¿”å›žä¸Šçº§                   |
| `g`             | è·³åˆ°é¡¶éƒ¨                   |
| `G`             | è·³åˆ°åº•éƒ¨                   |
| `a`             | æ·»åŠ åˆ°é˜Ÿåˆ—                 |
| `p`             | æ·»åŠ åˆ°æ­Œå•                 |
| `d`             | ä»Žåˆ—è¡¨ä¸­åˆ é™¤               |

### 5.3 æœç´¢ç•Œé¢

| é”®           | åŠ¨ä½œ              |
| ------------ | ----------------- |
| `Tab`        | åˆ‡æ¢æœç´¢ç±»åž‹      |
| `Ctrl+s`     | åˆ‡æ¢æŽ’åºæ–¹å¼      |
| `Esc`        | é€€å‡ºæœç´¢æ¡†        |

---

## 6. æ•°æ®æ¨¡åž‹ (æœ¬åœ°)

### 6.1 é…ç½®æ–‡ä»¶ `config.toml`

```toml
[player]
volume = 80
replay_gain = true
default_play_mode = "sequential"  # sequential | shuffle | repeat_one

[cache]
max_size_mb = 2048
path = "~/.cache/hachimi-tui/audio"

[display]
kids_mode = false

[auth]
# token å•ç‹¬å­˜æ”¾åœ¨ auth.json
```

### 6.2 è®¤è¯æ•°æ® `auth.json`

```json
{
  "access_token": "...",
  "refresh_token": "...",
  "expires_at": 1700000000
}
```

### 6.3 æ’­æ”¾é˜Ÿåˆ—æŒä¹…åŒ– `queue.json`

```json
{
  "current_index": 2,
  "position_ms": 151000,
  "songs": [
    { "id": 123, "title": "...", "audio_url": "..." }
  ]
}
```

---

## 7. API å¯¹æŽ¥

åŸºäºŽ hachimi-world æœåŠ¡ç«¯ APIï¼ŒTUI å®¢æˆ·ç«¯éœ€å¯¹æŽ¥ä»¥ä¸‹ç«¯ç‚¹ï¼š

### è®¤è¯
| æ–¹æ³• | ç«¯ç‚¹                      | ç”¨é€”         |
| ---- | ------------------------- | ------------ |
| POST | `/auth/login/email`       | é‚®ç®±ç™»å½•     |
| POST | `/auth/refresh_token`     | åˆ·æ–° token   |
| GET  | `/auth/captcha/generate`  | ç”ŸæˆéªŒè¯ç    |
| POST | `/auth/captcha/submit`    | æäº¤éªŒè¯ç    |

### æ­Œæ›²
| æ–¹æ³• | ç«¯ç‚¹                      | ç”¨é€”               |
| ---- | ------------------------- | ------------------ |
| GET  | `/song/recent_v2`        | æœ€æ–°å‘å¸ƒ           |
| GET  | `/song/recommend`         | æŽ¨èï¼ˆç™»å½•ï¼‰       |
| GET  | `/song/recommend_anonymous` | æŽ¨èï¼ˆåŒ¿åï¼‰    |
| GET  | `/song/hot/weekly`        | æ¯å‘¨çƒ­é—¨           |
| GET  | `/song/search`            | æœç´¢æ­Œæ›²           |
| GET  | `/song/detail_by_id`      | æ­Œæ›²è¯¦æƒ…           |
| GET  | `/song/detail`            | é€šè¿‡ JMID èŽ·å–è¯¦æƒ… |
| GET  | `/song/tag/recommend`     | æŽ¨èæ ‡ç­¾           |
| GET  | `/song/page_by_user`      | ç”¨æˆ·çš„æ­Œæ›²         |

### æ­Œå•
| æ–¹æ³• | ç«¯ç‚¹                         | ç”¨é€”             |
| ---- | ---------------------------- | ---------------- |
| GET  | `/playlist/list`             | æˆ‘çš„æ­Œå•åˆ—è¡¨     |
| GET  | `/playlist/detail_private`   | æ­Œå•è¯¦æƒ…ï¼ˆç§æœ‰ï¼‰ |
| GET  | `/playlist/detail`           | æ­Œå•è¯¦æƒ…ï¼ˆå…¬å¼€ï¼‰ |
| POST | `/playlist/create`           | åˆ›å»ºæ­Œå•         |
| POST | `/playlist/delete`           | åˆ é™¤æ­Œå•         |
| POST | `/playlist/add_song`         | æ·»åŠ æ­Œæ›²åˆ°æ­Œå•   |
| POST | `/playlist/remove_song`      | ä»Žæ­Œå•ç§»é™¤æ­Œæ›²   |
| POST | `/playlist/change_order`     | è°ƒæ•´æ­Œæ›²é¡ºåº     |
| GET  | `/playlist/search`           | æœç´¢æ­Œå•         |
| GET  | `/playlist/list_containing`  | æŸ¥è¯¢å«æŸæ­Œæ›²çš„æ­Œå• |
| GET  | `/playlist/list_public_by_user` | ç”¨æˆ·å…¬å¼€æ­Œå•  |
| GET  | `/playlist/favorite/page`    | æ”¶è—çš„æ­Œå•       |
| POST | `/playlist/favorite/add`     | æ”¶è—æ­Œå•         |
| POST | `/playlist/favorite/remove`  | å–æ¶ˆæ”¶è—         |
| GET  | `/playlist/favorite/check`   | æ£€æŸ¥æ˜¯å¦å·²æ”¶è—   |

### ç”¨æˆ·
| æ–¹æ³• | ç«¯ç‚¹                  | ç”¨é€”         |
| ---- | --------------------- | ------------ |
| GET  | `/user/profile`       | ç”¨æˆ·èµ„æ–™     |
| GET  | `/user/search`        | æœç´¢ç”¨æˆ·     |

### æ’­æ”¾åŽ†å²
| æ–¹æ³• | ç«¯ç‚¹                          | ç”¨é€”           |
| ---- | ----------------------------- | -------------- |
| GET  | `/play_history/cursor`        | åˆ†é¡µèŽ·å–åŽ†å²   |
| POST | `/play_history/touch`         | è®°å½•æ’­æ”¾       |
| POST | `/play_history/touch_anonymous` | åŒ¿åè®°å½•æ’­æ”¾ |
| POST | `/play_history/delete`        | åˆ é™¤åŽ†å²è®°å½•   |

---

## 8. éžåŠŸèƒ½éœ€æ±‚

### 8.1 æ€§èƒ½

- å¯åŠ¨æ—¶é—´ < 500ms
- åˆ—è¡¨æ»šåŠ¨æµç•…ï¼Œæ— å¡é¡¿
- éŸ³é¢‘æ’­æ”¾åœ¨ç‹¬ç«‹çº¿ç¨‹ï¼Œä¸é˜»å¡ž UI
- ç½‘ç»œè¯·æ±‚å¼‚æ­¥æ‰§è¡Œï¼Œå¸¦è¶…æ—¶å’Œé‡è¯•

### 8.2 å¯é æ€§

- ç½‘ç»œæ–­å¼€æ—¶ä¼˜é›…é™çº§ï¼ˆä½¿ç”¨ç¼“å­˜ï¼‰
- token è¿‡æœŸè‡ªåŠ¨åˆ·æ–°ï¼Œåˆ·æ–°å¤±è´¥æç¤ºé‡æ–°ç™»å½•
- æ’­æ”¾é˜Ÿåˆ—å´©æºƒæ¢å¤ï¼ˆæŒä¹…åŒ–ï¼‰

### 8.3 å…¼å®¹æ€§

- æ”¯æŒä¸»æµç»ˆç«¯ï¼šiTerm2, Alacritty, Kitty, WezTerm, Windows Terminal
- æœ€ä½Žç»ˆç«¯å®½åº¦ï¼š80 åˆ—
- æ”¯æŒ macOS, Linux (Windows ä½œä¸ºæ¬¡è¦ç›®æ ‡)

### 8.4 å®‰å…¨æ€§

- token æ–‡ä»¶æƒé™è®¾ä¸º 600
- ä¸åœ¨æ—¥å¿—ä¸­æ‰“å°æ•æ„Ÿä¿¡æ¯
- HTTPS é€šä¿¡

---

## 9. å¼€å‘é˜¶æ®µè§„åˆ’

### Phase 1 â€” åŸºç¡€éª¨æž¶

- é¡¹ç›®åˆå§‹åŒ– (Cargo workspace)
- Ratatui åŸºæœ¬æ¡†æž¶æ­å»º
- è®¤è¯æµç¨‹ï¼ˆç™»å½• + token æŒä¹…åŒ–ï¼‰
- API å®¢æˆ·ç«¯å°è£…

### Phase 2 â€” æ ¸å¿ƒæ’­æ”¾

- rodio éŸ³é¢‘æ’­æ”¾é›†æˆ
- æ’­æ”¾æŽ§åˆ¶ï¼ˆæ’­æ”¾/æš‚åœ/ä¸Šä¸€æ›²/ä¸‹ä¸€æ›²/seekï¼‰
- æ’­æ”¾é˜Ÿåˆ—ç®¡ç†
- åº•éƒ¨æ’­æ”¾çŠ¶æ€æ 

### Phase 3 â€” å†…å®¹æµè§ˆ

- Miller Columns ä¸‰æ å¯¼èˆªæ¡†æž¶
- é¦–é¡µï¼ˆæœ€æ–°/æŽ¨è/çƒ­é—¨ï¼‰
- æœç´¢åŠŸèƒ½ï¼ˆæ­Œæ›²/ç”¨æˆ·/æ­Œå•ï¼‰
- æ­Œæ›²åˆ—è¡¨äº¤äº’

### Phase 4 â€” æ­Œå•ä¸ŽåŽ†å²

- æ­Œå• CRUD
- æ”¶è—æ­Œå•
- æ’­æ”¾åŽ†å²
- ç”¨æˆ·ç©ºé—´

### Phase 5 â€” å¢žå¼ºä½“éªŒ

- ç¦»çº¿ç¼“å­˜ç³»ç»Ÿ
- æ­Œè¯åŒæ­¥æ˜¾ç¤º
- ReplayGain
- æ’­æ”¾é˜Ÿåˆ—æŒä¹…åŒ–

### Phase 6 â€” æ‰“ç£¨

- é”™è¯¯å¤„ç†å®Œå–„
- ç»ˆç«¯å…¼å®¹æ€§æµ‹è¯•
- æ€§èƒ½ä¼˜åŒ–
- é…ç½®æ–‡ä»¶æ”¯æŒ
